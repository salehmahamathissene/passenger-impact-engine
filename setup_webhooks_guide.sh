#!/bin/bash
echo "ü™ù SETTING UP STRIPE WEBHOOKS"
echo "=============================="

echo ""
echo "1Ô∏è‚É£ Go to Stripe Dashboard:"
echo "   https://dashboard.stripe.com/test/webhooks"
echo ""
echo "2Ô∏è‚É£ Click 'Add endpoint':"
echo "   URL: http://127.0.0.1:8080/enterprise/billing/webhook"
echo ""
echo "3Ô∏è‚É£ Select events:"
echo "   ‚Ä¢ checkout.session.completed"
echo "   ‚Ä¢ customer.subscription.created"
echo "   ‚Ä¢ customer.subscription.updated"
echo "   ‚Ä¢ invoice.payment_succeeded"
echo ""
echo "4Ô∏è‚É£ Copy the 'Signing secret' (starts with 'whsec_')"
echo ""
echo "5Ô∏è‚É£ Update .env.working:"
echo "   export STRIPE_WEBHOOK_SECRET='whsec_REDACTED_secret_here'"
echo ""
echo "6Ô∏è‚É£ Restart server:"
echo "   pkill -f 'uvicorn.*127.0.0.1.*8080'"
echo "   source .env.working"
echo "   export PYTHONPATH=\"\$PWD/src\""
echo "   uvicorn pie.api.app:app --host 127.0.0.1 --port 8080"
echo ""
echo "üìù For testing without real webhooks, use manual update below:"
